# Подключение MPI версии
## Компиляция MPI версии библиотеки
В библиотеку добавлены MPI-версии классов, работающие на многопроцессорных системах.
Для корректной сборки проекта требуется реализация стандарта MPI2.
Для Linux это mpich2.

Также, для корректной сборки проекта в зоне видимости переменной PATH должен быть компилятор mpicxx.

Сборку следует запускать со следующим параметром:
```
qmake PartsEngine.pro MODES+=mpi
```

## Добавление MPI в QT проект
При подключении библиотеки к сторонним проектам следует вместо:
```
LIBS += -L$$PWD/../../partsEngine/ -lPartsEngine
```
добавлять:
```
LIBS += -L$$PWD/../../partsEngine/ -lPartsEngineMpi
QMAKE_CXX = mpicxx
QMAKE_CXX_RELEASE = $$QMAKE_CXX
QMAKE_CXX_DEBUG = $$QMAKE_CXX
QMAKE_LINK = $$QMAKE_CXX
QMAKE_CC = mpicc
```
Это заменяет подгружаемую библиотеку partsEngine на ее mpi реализацию, и подменяет cxx компиллятор на mpicxx.

## Запуск MPI-программы из среды QT
Запустить программу можно из консоли, методом:
```
mpirun -n 3 ./myMpiProgram
```
Здесь число 3 - это количество запускаемых потоков. Также, можно настроить среду Qt для автоматического запуска скомпилированной программы (в таком случае не удалось настроить отладчик GDB).
Для этого, открываем свой проект, переходим на страницу "Проекты", "сборка и запуск", ниже выбираем "запуск". В поле "Конфигурация запуска" жмем "добавить" и "особая программа".
В форме ниже указываем следующие данные:

Программа: mpirun

Параметры:  -n 3 ./%{CurrentProject:Name}

Рабочий каталог: %{buildDir}

Если нужно запускать в отдельном терминале, жмем "запускать в терминале".

Все! Теперь, для запуска жмем зеленую кнопку "Play", либо ctrl+R. Запуск дебаг-версии не работает в виду несовместимости отладчика GDB c mpirun утилитой.